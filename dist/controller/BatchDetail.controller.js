sap.ui.define(["sap/ui/core/mvc/Controller"],function(t){"use strict";return t.extend("crm.crmbatchtest.controller.BatchDetail",{ALL_STAGES:["HSM","Pickling","Oiling","Rewinding","Color Coating","Galvanizing"],onInit:function(){this.getOwnerComponent().getRouter().getRoute("batchDetail").attachPatternMatched(this._onMatched,this)},_onMatched:function(t){this._batchId=t.getParameter("arguments").id;this._renderTree()},_getRoutingData:function(t){const e={H12345:{required:5,current:2,delay:2,sold:false},H12346:{required:2,current:2,delay:null,sold:true},H12347:{required:3,current:3,delay:null,sold:false},H12348:{required:5,current:4,delay:null,sold:false},H12349:{required:5,current:5,delay:null,sold:false},H12350:{required:1,current:1,delay:null,sold:true},H12351:{required:4,current:2,delay:2,sold:false},H12352:{required:3,current:1,delay:null,sold:false},H12353:{required:5,current:5,delay:null,sold:false},H12354:{required:2,current:0,delay:null,sold:false}};const r=e[t];if(!r)return null;const n=[];for(let t=0;t<=r.required;t++){let e="Pending";if(t<r.current)e="Completed";if(t===r.current)e=r.sold?"Sold":"In Process";n.push({name:this.ALL_STAGES[t],status:e,delay:r.delay===t})}return{name:t,children:n}},_renderTree:function(){const t=document.getElementById("crmProcessTree");if(!t)return;t.innerHTML="";const e=this._getRoutingData(this._batchId);if(!e)return;const r=t.clientWidth;const n=r<768;const a={top:80,right:250,bottom:80,left:120};let l=800;const s=d3.select(t).append("svg").attr("width",r).attr("height",l).style("background","#f9fafb").call(d3.zoom().scaleExtent([.5,3]).on("zoom",function(t){o.attr("transform",t.transform)}));const o=s.append("g").attr("transform",`translate(${a.left},${a.top})`);let d=0;const i=500;const c=d3.tree().nodeSize([n?200:180,n?200:260]);let u=d3.hierarchy(e);f(u);function f(t){const e=c(u);const a=e.descendants();const f=e.links();l=Math.max(800,a.length*180);s.attr("height",l);const h=o.selectAll("g.node").data(a,t=>t.id||(t.id=++d));const p=h.enter().append("g").attr("class","node").attr("transform",`translate(${t.y0||0},${t.x0||0})`);p.append("circle").attr("r",18).style("fill",t=>t.data.delay?"#e74c3c":"#2c3e50");p.append("text").attr("x",35).attr("dy",".35em").style("font-weight","600").style("font-size","14px").text(t=>t.data.name);p.append("text").attr("class","toggleBtn").attr("x",0).attr("y",-35).attr("font-size","22px").attr("text-anchor","middle").attr("cursor","pointer").text("+").on("click",function(t,e){t.stopPropagation();const a=d3.select(this.parentNode);const l=a.select(".detailCard");if(!l.empty()){l.remove();d3.select(this).text("+");return}d3.select(this).text("âˆ’");const s=n?r-100:320;const o=150;const d=a.append("g").attr("class","detailCard").attr("transform",`translate(${n?0:180},40)`);d.append("rect").attr("width",s).attr("height",o).attr("rx",12).attr("ry",12).style("fill","#ffffff").style("stroke","#ddd").style("stroke-width","1.5px").style("filter","drop-shadow(2px 4px 8px rgba(0,0,0,0.15))");const i=[`Plant: CRM01`,`Batch: ${u.data.name}`,`Stage: ${e.data.name}`,`Status: ${e.data.status}`,`Delay: ${e.data.delay?"YES ðŸ”´":"No ðŸŸ¢"}`];d.selectAll("text").data(i).enter().append("text").attr("x",20).attr("y",(t,e)=>35+e*25).text(t=>t).attr("font-size","13px")});const g=p.merge(h);g.transition().duration(i).attr("transform",t=>`translate(${t.y},${t.x})`);h.exit().remove();const y=o.selectAll("path.link").data(f,t=>t.target.id);y.enter().insert("path","g").attr("class","link").merge(y).transition().duration(i).attr("d",d3.linkHorizontal().x(t=>t.y).y(t=>t.x)).style("fill","none").style("stroke","#ccc").style("stroke-width","2px");y.exit().remove()}},onNavBack:function(){this.getOwnerComponent().getRouter().navTo("home")}})});
//# sourceMappingURL=BatchDetail.controller.js.map